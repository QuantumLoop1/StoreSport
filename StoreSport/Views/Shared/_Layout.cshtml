<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SportsStore</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f5f5f5; }
    .card { border: none; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
        .cart-count {
            position: absolute;
            top: -6px;
    right: -8px;
       background: #e53935;
 color: white;
border-radius: 50%;
            width: 18px;
height: 18px;
     font-size: 11px;
        display: none;
    align-items: center;
 justify-content: center;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark mb-4">
        <div class="container">
   <a class="navbar-brand" asp-controller="Home" asp-action="Index">SportsStore</a>
    <div class="d-flex gap-4">
            <a class="text-white text-decoration-none position-relative" asp-controller="Order" asp-action="Checkout">
               Cart <span class="cart-count" id="cartCount">0</span>
           </a>
      <a class="text-white text-decoration-none" asp-controller="Admin" asp-action="Index">Admin</a>
            </div>
   </div>
    </nav>
    
    @if (TempData["message"] != null)
    {
        <div class="container">
            <div class="alert alert-success">@TempData["message"]</div>
    </div>
    }
    
    <div class="container">
        @RenderBody()
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    function updateCartCount() {
  fetch('/Cart/GetCartItemCount')
        .then(r => r.json())
  .then(data => {
              const badge = document.getElementById('cartCount');
   if (data.count > 0) {
          badge.textContent = data.count;
     badge.style.display = 'flex';
     } else {
         badge.style.display = 'none';
    }
     });
   }
        document.addEventListener('DOMContentLoaded', updateCartCount);
        document.querySelectorAll('form[action*="AddToCart"]').forEach(form => {
            form.addEventListener('submit', () => setTimeout(updateCartCount, 500));
        });
    </script>
    
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
